# 绘制辅助

## 范围裁切

裁切方法之后的绘制代码，都会被限制在裁切范围内。

一般情况下要加上 Canvas.save() 和 Canvas.restore() 来及时恢复绘制范围。

### clideRect()

Canvas.clipRect(RectF rect); 

### clipPath()

canvas.clipPath(Path path);  

其实和 clipRect() 用法完全一样，只是把参数换成了 Path ，所以能裁切的形状更多一些。

## 几何变换

### 使用 Canvas 做二维变化

#### 平移 translate

Canvas.translate(float dx, float dy)

#### 旋转 rotate

Canvas.rotate(float degrees, float px, float py) 

- degrees - 旋转角度
- px / py - 轴心坐标

#### 放缩 scale

- sx - 横向缩放倍数
- sy - 纵向缩放倍数
- px / py - 轴心坐标

#### 错切 skew

Canvas.skew(float sx, float sy)

- sx / sy - x 方向和 y 方向的错切系数

### 使用 Matrix 来做变换

#### 使用 Matrix 来做常见变换

Matrix 做常见变换的方式：

1. 创建 Matrix 对象；
2. 调用 Matrix 的 pre/postTranslate/Rotate/Scale/Skew() 方法来设置几何变换；
3. 使用 Canvas.setMatrix(matrix) 或 Canvas.concat(matrix) 来把几何变换应用到 Canvas。


- Canvas.setMatrix(matrix)：用 Matrix 直接替换 Canvas 当前的变换矩阵，即抛弃 Canvas 当前的变换，改用 Matrix 的变换（注：不同的系统中 setMatrix(matrix) 的行为可能不一致，所以还是尽量用 concat(matrix) 吧）；
  
- Canvas.concat(matrix)：用 Canvas 当前的变换矩阵和 Matrix 相乘，即基于 Canvas 当前的变换，叠加上 Matrix 中的变换。

#### 使用 Matrix 来做自定义变换

Matrix.setPolyToPoly(float[] src, int srcIndex, float[] dst, int dstIndex, int pointCount) 

用多个点对点映射的方式设置变换。例如：(0, 0) -> (100, 100) 表示把 (0, 0) 位置的像素移动到 (100, 100) 的位置。

- src - 源点集合，（两个数值为1个点）
- srcIndex - 以src中第几个坐标点作为第一个映射点
- dst - 目标点集
- dstIndex - 以dst中第几个坐标点作为第一个映射点
- pointCount 映射点的个数（不能大于4）

```java
float[] pointsSrc = new float[]{left, top, right, top, left, bottom, right, bottom};
float[] pointsDst = new float[]{left - 10, top + 50, right + 120, top - 90, left + 20, bottom + 30, right + 20,
        bottom + 60};

matrix.reset();
matrix.setPolyToPoly(pointsSrc, 0, pointsDst, 0, 4);

canvas.save();
canvas.concat(matrix);
canvas.drawBitmap(bitmap, left, top, paint);
canvas.restore();
```

<img src="../pictures//52eb2279ly1fig5uw4t2jj20q60fcag4.jpg"/>

## 使用 Camera 来做三维变换